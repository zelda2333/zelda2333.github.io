<h3 id="section">安装必要工具</h3>
<p>使用devstack需要两个工具软件：git 和 pip</p>

<div class="highlighter-rouge"><pre class="highlight"><code>apt-get install git
apt-get install python-pip
</code></pre>
</div>

<h3 id="pip">配置pip源</h3>
<p>推荐使用的pip源是豆瓣的源。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>zelda@zelda-Lenovo-Erazer-Z410:~$ mkdir ~/.pip
zelda@zelda-Lenovo-Erazer-Z410:~$ cd ~/.pip
zelda@zelda-Lenovo-Erazer-Z410:~/.pip$ vi pip.conf
</code></pre>
</div>

<p>然后在该目录下创建pip.conf文件编写如下内容：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[global]
trusted-host =  pypi.douban.com
index-url = http://pypi.douban.com/simple
</code></pre>
</div>

<p>sudo apt install openssh-server
sudo apt install git
接着给root用户设置密码
sudo passwd root
配置openssh使root用户可以登录
修改
sudo vim /etc/ssh/sshd_config
PermitRootLogin 修改为yes
之后重启ssh服务,在实体机用root登录
sudo service ssh restart</p>

<p>创建openstack用户,并且配置</p>

<p>创建用户
sudo useradd -s /bin/bash -d /opt/stack -m stack
让stack用户在使用sudo的时候不需要密码
echo “stack ALL=(ALL) NOPASSWD: ALL” | sudo tee /etc/sudoers.d/stack
切换到stack用户
sudo su - stack</p>

<p>安装下载devstack</p>

<p>因为国内的环境问题,所以下载的时候推荐使用trystack.cn的镜像
先创建一个文件夹
mkdir openstack
cd openstack/
git clone http://git.trystack.cn/openstack-dev/devstack</p>

<p>修改local.conf文件</p>

<p>cd devstack/
创建local.conf
touch local.conf</p>

<p>[[local|localrc]]
# use TryStack git mirror
GIT_BASE=http://git.trystack.cn
NOVNC_REPO=http://git.trystack.cn/kanaka/noVNC.git
SPICE_REPO=http://git.trystack.cn/git/spice/spice-html5.git
#OFFLINE=True
RECLONE=True
# Define images to be automatically downloaded during the DevStack built process.
DOWNLOAD_DEFAULT_IMAGES=False
IMAGE_URLS=”http://download.cirros-cloud.net/0.3.5/cirros-0.3.5-x86_64-disk.img”
HOST_IP=192.168.1.107</p>

<h1 id="credentials">Credentials</h1>
<p>DATABASE_PASSWORD=woyaoxuehuilinux
ADMIN_PASSWORD=woyaoxuehuilinux
SERVICE_PASSWORD=woyaoxuehuilinux
SERVICE_TOKEN=woyaoxuehuilinux
RABBIT_PASSWORD=woyaoxuehuilinux
HORIZON_BRANCH=master
KEYSTONE_BRANCH=master
NOVA_BRANCH=master
NEUTRON_BRANCH=master
GLANCE_BRANCH=master
CINDER_BRANCH=master</p>

<h1 id="keystone">keystone</h1>
<p>KEYSTONE_TOKEN_FORMAT=UUID
##Heat
HEAT_BRANCH=master
enable_service h-eng h-api h-api-cfn h-api-cw</p>

<h2 id="swift">Swift</h2>
<p>SWIFT_BRANCH=master
ENABLED_SERVICES+=,s-proxy,s-object,s-container,s-account
SWIFT_REPLICAS=1
SWIFT_HASH=011688b44136573e209e</p>

<h1 id="enabling-neutron-network-service">Enabling Neutron (network) Service</h1>
<p>disable_service n-net
enable_service q-svc
enable_service q-agt
enable_service q-dhcp
enable_service q-l3
enable_service q-meta
enable_service q-metering
enable_service neutron
## Neutron options
Q_USE_SECGROUP=True
FLOATING_RANGE=”192.168.1.0/24”
FIXED_RANGE=”10.0.0.0/24”
Q_FLOATING_ALLOCATION_POOL=start=192.168.1.102,end=192.168.1.110
PUBLIC_NETWORK_GATEWAY=”192.168.1.2”
Q_L3_ENABLED=True
PUBLIC_INTERFACE=eth0
Q_USE_PROVIDERNET_FOR_PUBLIC=True
OVS_PHYSICAL_BRIDGE=br-ex
PUBLIC_BRIDGE=br-ex
OVS_BRIDGE_MAPPINGS=public:br-ex
# #VLAN configuration.
Q_PLUGIN=ml2
ENABLE_TENANT_VLANS=True
# Logging
LOGFILE=/opt/stack/logs/stack.sh.log
VERBOSE=True
LOG_COLOR=True
SCREEN_LOGDIR=/opt/stack/logs</p>

<p>下面这三句话是使用trystack.cn的openstack镜像的意思</p>

<p>GIT_BASE=http://git.trystack.cn
NOVNC_REPO=http://git.trystack.cn/kanaka/noVNC.git
SPICE_REPO=http://git.trystack.cn/git/spice/spice-html5.git</p>

<p>上面这个配置文件有几个地方是要你去修改的
HOST_IP=192.168.1.107 你的主机ip</p>

<p>DATABASE_PASSWORD=woyaoxuehuilinux
ADMIN_PASSWORD=woyaoxuehuilinux
SERVICE_PASSWORD=woyaoxuehuilinux
SERVICE_TOKEN=woyaoxuehuilinux
RABBIT_PASSWORD=woyaoxuehuilinux</p>

<p>上面是一些openstack dashboard或者数据库等密码</p>

<p>HORIZON_BRANCH=master
KEYSTONE_BRANCH=master
NOVA_BRANCH=master
NEUTRON_BRANCH=master
GLANCE_BRANCH=master
CINDER_BRANCH=master</p>

<p>上面的master表示你下载的openstack所在的git分支,使用master就好了
SWIFT_BRANCH=master
HEAT_BRANCH=master
这上面两个参数也同理
FLOATING_RANGE=”192.168.1.0/24”
这个参数的ip地址要和你的主机的ip地址处于同一网段
其他的参数自己研究把,反正不影响安装,记住百度很重要</p>

<p>安装</p>

<p>在这下面我会把我安装的时候碰到的错误详细的说出来
首先执行
./stack.sh</p>

